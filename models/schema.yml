version: 2

sources:

  - name: DB_01
    database: DB_01
    schema: PUBLIC
    tables:
            - name: CLAIMSDEC

models:
        - name: claims
          columns:
                  - name: Policy No
                    meta:
                      metrics:
                        claim_count:
                          type: count
                          sql: Policy No
                  - name: Intimation_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: Settlement_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: LOB
                  - name: Fiscal_year
                  - name: Claim Amount  (BASE + RIDER) 
                    meta:
                      metrics:
                        claim_amount_sum:
                          type: sum
                          sql: Claim Amount  (BASE + RIDER)/10000000
                          round: 2
                          format: 'inr'
                        claim_amount_avg:
                          type: average
                          sql: Claim Amount  (BASE + RIDER)
                          format: 'inr'
                  - name: Servicing Branch Name
                  - name: Channel-1
                  - name: Early/Non Early
                  - name: Writing Agent State Name
                  - name: Nature of Base Policy
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR

        - name: Settlement
          # meta:
          #   joins:
          #     - join: claims
          #       sql_on: $()


          columns:
                  - name: POLICY_NO
                    meta:
                      metrics:
                        claim_count:
                          type: count
                          sql: POLICY_NO
                  - name: Settlement_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: Claim Amount  (BASE + RIDER)
                    meta:
                      metrics:
                        claim_amount_sum:
                          type: sum
                          sql: Claim Amount  (BASE + RIDER)/10000000
                          format: 'inr'
                  - name: Fiscal_year
                  - name: Channel-1
                  - name: Early/Non Early
                  - name: Writing Agent State Name
                  - name: LOB

