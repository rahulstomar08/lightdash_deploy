version: 2

sources:

  - name: DB_01
    database: DB_01
    schema: PUBLIC
    tables:
            - name: CLAIMSDEC

models:
        - name: claims
          columns:
                  - name: POLICY_NO
                    meta:
                      metrics:
                        claim_count:
                          type: count
                          sql: POLICY_NO
                  - name: Intimation_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: Settlement_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: LOB
                  - name: Fiscal_year
                  - name: CLAIM_AMOUNT
                    meta:
                      metrics:
                        claim_amount_sum:
                          type: sum
                          sql: CLAIM_AMOUNT/10000000
                          round: 2
                          format: 'inr'
                        claim_amount_avg:
                          type: average
                          sql: CLAIM_AMOUNT
                          format: 'inr'
                  - name: SERVICING_BRANCH_NAME
                  - name: CHANNEL1
                  - name: EARLYNON_EARLY
                  - name: WRITING_AGENT_STATE_NAME
                  - name: NATURE_OF_BASE_POLICY
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR

        - name: Settlement
          # meta:
          #   joins:
          #     - join: claims
          #       sql_on: 


          columns:
                  - name: POLICY_NO
                    meta:
                      metrics:
                        claim_count:
                          type: count
                          sql: POLICY_NO
                  - name: Settlement_Date
                    meta:
                      dimension:
                        time_intervals:
                          - DAY
                          - WEEK
                          - MONTH
                          - QUARTER
                          - YEAR
                  - name: CLAIM_AMOUNT
                    meta:
                      metrics:
                        claim_amount_sum:
                          type: sum
                          sql: CLAIM_AMOUNT/10000000
                          format: 'inr'
                  - name: Fiscal_year
                  - name: CHANNEL1
                    meta:
                      dimension:
                        label: 'Channel'
                  - name: EARLYNON_EARLY
                    meta:
                      dimension:
                        label: 'Early/Non Early'
                  - name: WRITING_AGENT_STATE_NAME
                  - name: LOB

